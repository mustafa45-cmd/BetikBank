<!-- Dashboard SayfasÄ± - Ana kontrol paneli -->
{% extends "base.html" %}

{% block title %}Ana Sayfa - BetikBank{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="container">
        <!-- KullanÄ±cÄ± HoÅŸ Geldin MesajÄ± -->
        <h1 class="page-title">HoÅŸ Geldiniz, {{ current_user.ad }} {{ current_user.soyad }}</h1>
        
        <!-- Hesaplar BÃ¶lÃ¼mÃ¼ -->
        <div class="accounts-section">
            <h2 class="section-title">HesaplarÄ±m</h2>
            <div class="accounts-grid">
                <!-- Normal Banka HesaplarÄ± -->
                {% for hesap in hesaplar %}
                <div class="account-card">
                    <div class="account-header">
                        <h3>{{ hesap.hesap_turu }}</h3>
                        <span class="account-badge">Aktif</span>
                    </div>
                    <div class="account-body">
                        <p class="account-number">{{ hesap.hesap_no }}</p>
                        <p class="account-balance">{{ "%.2f"|format(hesap.bakiye) }} TL</p>
                    </div>
                    <div class="account-footer">
                        <a href="{{ url_for('account_detail', hesap_id=hesap.id) }}" class="btn btn-secondary btn-small">Detaylar</a>
                    </div>
                </div>
                {% endfor %}
                
                <!-- YatÄ±rÄ±m HesaplarÄ± -->
                {% for yatirim in yatirim_hesaplari %}
                <div class="account-card investment-account-card">
                    <div class="account-header">
                        <h3>ğŸ“ˆ {{ yatirim.yatirim_turu }}</h3>
                        <span class="account-badge investment-badge">YatÄ±rÄ±m</span>
                    </div>
                    <div class="account-body">
                        <p class="account-number">{{ yatirim.hesap_no }}</p>
                        <p class="account-balance">{{ "%.2f"|format(yatirim.toplam_bakiye) }} TL</p>
                        {% if yatirim.kar_zarar != 0 %}
                        <p class="account-profit {% if yatirim.kar_zarar >= 0 %}text-success{% else %}text-danger{% endif %}" style="font-size: 0.9rem; margin-top: 0.5rem;">
                            {% if yatirim.kar_zarar >= 0 %}+{% endif %}{{ "%.2f"|format(yatirim.kar_zarar) }} TL
                        </p>
                        {% endif %}
                    </div>
                    <div class="account-footer">
                        <a href="{{ url_for('investment_detail', yatirim_id=yatirim.id) }}" class="btn btn-secondary btn-small">Detaylar</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% if hesaplar|length == 0 and (yatirim_hesaplari|length == 0 if yatirim_hesaplari else True) %}
            <p class="empty-state">HenÃ¼z hesabÄ±nÄ±z bulunmamaktadÄ±r.</p>
            {% endif %}
        </div>

        <!-- Kartlar BÃ¶lÃ¼mÃ¼ -->
        <div class="cards-section">
            <div class="section-header">
                <h2 class="section-title">KartlarÄ±m</h2>
                <a href="{{ url_for('cards') }}" class="btn-link">TÃ¼mÃ¼nÃ¼ GÃ¶r</a>
            </div>
            {% if kartlar and kartlar|length > 0 %}
            <!-- Ä°lk 3 kartÄ± gÃ¶ster -->
            <div class="cards-grid">
                {% for kart in kartlar[:3] %}
                <div class="card-item">
                    <div class="card-header">
                        <h3>{{ kart.kart_turu }}</h3>
                        <span class="card-status">{{ kart.durum }}</span>
                    </div>
                    <div class="card-body">
                        <p class="card-number">**** **** **** {{ kart.kart_no[-4:] }}</p>
                        <p class="card-owner">{{ kart.kart_sahibi_adi }}</p>
                        <p class="card-expiry">SKT: {{ kart.son_kullanim_tarihi }}</p>
                        {% if kart.limit > 0 %}
                        <p class="card-limit">Limit: {{ "%.2f"|format(kart.limit) }} TL</p>
                        {% endif %}
                    </div>
                    <div class="card-footer">
                        <a href="{{ url_for('card_detail', kart_id=kart.id) }}" class="btn btn-secondary btn-small">Detaylar</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="empty-state">HenÃ¼z kartÄ±nÄ±z bulunmamaktadÄ±r. <a href="{{ url_for('new_card') }}">Yeni kart oluÅŸturun</a></p>
            {% endif %}
        </div>

        <!-- YatÄ±rÄ±m HesaplarÄ± BÃ¶lÃ¼mÃ¼ -->
        <div class="investment-section">
            <div class="section-header">
                <h2 class="section-title">YatÄ±rÄ±m HesaplarÄ±m</h2>
                <a href="{{ url_for('investment') }}" class="btn-link">TÃ¼mÃ¼nÃ¼ GÃ¶r</a>
            </div>
            {% if yatirim_hesaplari and yatirim_hesaplari|length > 0 %}
            <!-- Ä°lk 3 yatÄ±rÄ±m hesabÄ±nÄ± gÃ¶ster -->
            <div class="investment-grid">
                {% for yatirim in yatirim_hesaplari[:3] %}
                <div class="investment-card">
                    <div class="investment-header">
                        <h3>{{ yatirim.yatirim_turu }}</h3>
                        <span class="investment-status">{{ yatirim.durum }}</span>
                    </div>
                    <div class="investment-body">
                        <p class="investment-number">{{ yatirim.hesap_no }}</p>
                        <p class="investment-balance">{{ "%.2f"|format(yatirim.toplam_bakiye) }} TL</p>
                        <p class="investment-profit {% if yatirim.kar_zarar >= 0 %}text-success{% else %}text-danger{% endif %}">
                            {% if yatirim.kar_zarar >= 0 %}+{% endif %}{{ "%.2f"|format(yatirim.kar_zarar) }} TL
                        </p>
                    </div>
                    <div class="investment-footer">
                        <a href="{{ url_for('investment_detail', yatirim_id=yatirim.id) }}" class="btn btn-secondary btn-small">Detaylar</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="empty-state">HenÃ¼z yatÄ±rÄ±m hesabÄ±nÄ±z bulunmamaktadÄ±r. <a href="{{ url_for('new_investment') }}">Yeni yatÄ±rÄ±m hesabÄ± aÃ§Ä±n</a></p>
            {% endif %}
        </div>

        <!-- Son Ä°ÅŸlemler BÃ¶lÃ¼mÃ¼ -->
        <div class="transactions-section">
            <h2 class="section-title">Son Ä°ÅŸlemler</h2>
            {% if son_islemler %}
            <div class="transactions-table-container">
                <table class="transactions-table">
                    <thead>
                        <tr>
                            <th>Tarih</th>
                            <th>AÃ§Ä±klama</th>
                            <th>GÃ¶nderen</th>
                            <th>AlÄ±cÄ±</th>
                            <th>Tutar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Son 10 iÅŸlemi gÃ¶ster -->
                        {% for islem in son_islemler %}
                        <tr>
                            <td>{{ islem.tarih.strftime('%d.%m.%Y %H:%M') }}</td>
                            <td>{{ islem.aciklama or '-' }}</td>
                            <td>{{ islem.gonderen_hesap.hesap_no }}</td>
                            <td>{{ islem.alici_hesap.hesap_no }}</td>
                            <td class="{% if islem.alici_hesap.kullanici_id == current_user.id %}text-success{% else %}text-danger{% endif %}">
                                {% if islem.alici_hesap.kullanici_id == current_user.id %}+{% else %}-{% endif %}{{ "%.2f"|format(islem.tutar) }} TL
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="text-center" style="margin-top: 20px;">
                <a href="{{ url_for('transactions') }}" class="btn btn-secondary">TÃ¼m Ä°ÅŸlemleri GÃ¶rÃ¼ntÃ¼le</a>
            </div>
            {% else %}
            <p class="empty-state">HenÃ¼z iÅŸlem yapÄ±lmamÄ±ÅŸ.</p>
            {% endif %}
        </div>

        <!-- HÄ±zlÄ± Ä°ÅŸlemler BÃ¶lÃ¼mÃ¼ -->
        <div class="quick-actions">
            <h2 class="section-title">HÄ±zlÄ± Ä°ÅŸlemler</h2>
            <div class="actions-grid">
                <!-- Para Transferi -->
                <a href="{{ url_for('transfer') }}" class="action-card">
                    <div class="action-icon">ğŸ’¸</div>
                    <h3>Para Transferi</h3>
                    <p>HÄ±zlÄ± para transferi yap</p>
                </a>
                <a href="{{ url_for('new_card') }}" class="action-card">
                    <div class="action-icon">ğŸ’³</div>
                    <h3>Yeni Kart</h3>
                    <p>Yeni kart oluÅŸtur</p>
                </a>
                <a href="{{ url_for('new_investment') }}" class="action-card">
                    <div class="action-icon">ğŸ“ˆ</div>
                    <h3>YatÄ±rÄ±m HesabÄ± AÃ§</h3>
                    <p>Yeni yatÄ±rÄ±m hesabÄ± aÃ§</p>
                </a>
                <a href="{{ url_for('transactions') }}" class="action-card">
                    <div class="action-icon">ğŸ“‹</div>
                    <h3>Ä°ÅŸlem GeÃ§miÅŸi</h3>
                    <p>TÃ¼m iÅŸlemlerinizi gÃ¶rÃ¼ntÃ¼le</p>
                </a>
                <a href="{{ url_for('cards') }}" class="action-card">
                    <div class="action-icon">ğŸ’³</div>
                    <h3>KartlarÄ±m</h3>
                    <p>KartlarÄ±nÄ±zÄ± yÃ¶netin</p>
                </a>
                <a href="{{ url_for('investment') }}" class="action-card">
                    <div class="action-icon">ğŸ“Š</div>
                    <h3>YatÄ±rÄ±mlarÄ±m</h3>
                    <p>YatÄ±rÄ±m hesaplarÄ±nÄ±zÄ± gÃ¶rÃ¼ntÃ¼le</p>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

